---
aliases: 
tags:
  - corsi/informatica/sistemi_operativi
paragrafo: Laboratorio SO
cssclasses:
  - 
---
### OPENDIR
La **`opendir()`** viene usata per *aprire una directory*.

```C
#include <sys/types.h>
#include <dirent.h>

DIR *opendir(const char *pathname); // Utilizza il nome

DIR *fdopendir(int fd); // Utilizza un file descriptor
```

**Parametri**: 
- *`pathname`*: il path della directory che si vuole aprire (gli si può passare `"."` per aprire la *cwd* (current working directory));
	- *`fd`*: [[009 Apertura di un file#^8ad3ec|File Descriptor]];

**Restituisce**:
-   Il *puntatore alla directory* se OK;
-   Altrimenti *NULL*.

## STRUCT DIRENT
La **`struct dirent`** (Directory Entry) è una struttura che facilita l'attraversamento di una directory.

```C
struct dirent{
	ino_t d_ino; // Numero dell'i-node della directory
	...
	char d_name[256]; // Nome della directory, terminato dal '/0'
};
```

### READDIR
La **`readdir()`** viene usata per *leggere il contenuto una directory*.

```C
#include <dirent.h>

struct dirent *readdir (DIR *dp);
```

**Parametri**: 
- *`dp`*: puntatore alla directory da attraversare;

**Restituisce**:
-   Il *puntatore alla struttura* se OK;
-   Altrimenti *NULL*.

> [!example]- <font color="orange">Stampare tutti i file e sub-directory della cwd</font>
>```C
>#include <stdio.h>
>#include <dirent.h>
>  
>int main(void){
>    struct dirent *de;  // Puntatore alla entry directory 
>  
>    // Ritorna il puntatore di tipo DIR. 
>    DIR *dr = opendir("."); // Gli viene passata la current working directory (".")
>  
>    if (dr == NULL)  // Vede se la directory è stata aperta correttamente
>    {
>        printf("Could not open current directory\n");
>        return 0;
>    }
>
>	// Ciclo per attraversare tutta la cwd
>    while ((de = readdir(dr)) != NULL)
>            printf("%s\n", de->d_name); // Stampa del nome
>  
>    closedir(dr);    
>    return 0;
>}
>```

___
%%
Creato il 07/11/2022, 09:21
Tag Materia: #corsi/informatica/sistemi_operativi 
%%
[[000 Indice SO|↖ Ritorna all'indice ↖]] , [[1004.L-SO Accesso ai File|← Nota Precedente]] | [[1006.L-SO Controllo Processi|Nota Successiva →]]

Altri collegamenti: [[010 Directory]]